<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CYBER COURIER 2049</title>
    <style>
        * { 
            margin: 0; padding: 0; box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }
        
        body {
            background: #0a0a1a;
            color: white;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            position: fixed;
        }
        
        #gameContainer {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        canvas {
            display: block;
            background: linear-gradient(to bottom, #000428, #004e92);
        }
        
        .ui-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }
        
        .stats {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #00ffea;
        }
        
        .stat {
            margin: 5px 0;
            font-size: 18px;
            text-shadow: 0 0 10px #00ffea;
        }
        
        .controls {
            position: absolute;
            bottom: 30px;
            width: 100%;
            display: flex;
            justify-content: space-around;
            padding: 0 20px;
        }
        
        .control-btn {
            pointer-events: auto;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: rgba(0, 255, 234, 0.2);
            border: 3px solid #00ffea;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(0, 255, 234, 0.5);
            transition: all 0.1s;
        }
        
        .control-btn:active {
            transform: scale(0.9);
            background: rgba(0, 255, 234, 0.4);
        }
        
        .logo {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            text-shadow: 0 0 20px #ff00ff;
            animation: pulse 2s infinite;
        }
        
        .logo h1 {
            font-size: 36px;
            color: #00ffea;
            margin-bottom: 10px;
        }
        
        .logo p {
            color: #ff6b00;
            font-size: 18px;
        }
        
        .start-btn {
            pointer-events: auto;
            margin-top: 30px;
            padding: 15px 40px;
            background: linear-gradient(45deg, #ff00ff, #00ffea);
            border: none;
            border-radius: 30px;
            color: white;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 30px rgba(255, 0, 255, 0.7);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .notification {
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid #ff6b00;
            text-align: center;
            animation: slideDown 0.5s;
        }
        
        @keyframes slideDown {
            from {
                top: -50px;
                opacity: 0;
            }
            to {
                top: 100px;
                opacity: 1;
            }
        }
        
        /* –ù–µ–æ–Ω–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã */
        .neon-text {
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 20px #fff,
                0 0 40px #0ff,
                0 0 80px #0ff,
                0 0 90px #0ff,
                0 0 100px #0ff,
                0 0 150px #0ff;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
</head>
<body>
    <div id="gameContainer">
        <!-- Game will be rendered here -->
    </div>
    
    <div class="ui-overlay">
        <!-- –õ–æ–≥–æ—Ç–∏–ø –∏ —Å—Ç–∞—Ä—Ç -->
        <div class="logo" id="startScreen">
            <h1 class="neon-text">CYBER COURIER 2049</h1>
            <p>–î–æ—Å—Ç–∞–≤–ª—è–π –¥–∞–Ω–Ω—ã–µ. –í—ã–∂–∏–≤–∞–π. –î–æ–º–∏–Ω–∏—Ä—É–π.</p>
            <button class="start-btn" onclick="startGame()">START RUN</button>
            <p style="margin-top: 20px; font-size: 14px; color: #aaa;">
                –¢–∞–ø/–ü—Ä–æ–±–µ–ª - –ø—Ä—ã–∂–æ–∫ | –£–¥–µ—Ä–∂–∞–Ω–∏–µ - —Å–ª–∞–π–¥
            </p>
        </div>
        
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã -->
        <div class="stats" style="display: none;" id="gameStats">
            <div class="stat">–î–∏—Å—Ç–∞–Ω—Ü–∏—è: <span id="distance">0</span>m</div>
            <div class="stat">–î–∞–Ω–Ω—ã–µ: <span id="data">0</span> GB</div>
            <div class="stat">–°–∫–æ—Ä–æ—Å—Ç—å: <span id="speed">x1.0</span></div>
            <div class="stat">–ñ–∏–∑–Ω–∏: <span id="lives">3</span> ‚ù§Ô∏è</div>
        </div>
        
        <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
        <div id="notification" class="notification" style="display: none;"></div>
        
        <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ -->
        <div class="controls" style="display: none;" id="gameControls">
            <button class="control-btn" id="jumpBtn">‚Üë</button>
            <button class="control-btn" id="slideBtn">‚Üì</button>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã
        const CONFIG = {
            PLAYER_SPEED: 300,
            GRAVITY: 800,
            JUMP_FORCE: -400,
            GROUND_HEIGHT: 100,
            OBSTACLE_SPEED: 200,
            DATA_SPAWN_RATE: 0.3
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            distance: 0,
            dataCollected: 0,
            speed: 1.0,
            lives: 3,
            isPlaying: false,
            score: 0,
            highScore: localStorage.getItem('cyberHighScore') || 0
        };

        // Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
        let tg;
        try {
            tg = window.Telegram.WebApp;
            tg.expand();
            tg.enableClosingConfirmation();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ–º—ã
            tg.setHeaderColor('#0a0a1a');
            tg.setBackgroundColor('#0a0a1a');
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const user = tg.initDataUnsafe?.user;
            if (user) {
                document.getElementById('startScreen').innerHTML += `
                    <div style="margin-top: 20px; padding: 10px; background: rgba(255,107,0,0.2); border-radius: 10px;">
                        <p>üëã –ü—Ä–∏–≤–µ—Ç, ${user.first_name}!</p>
                        <p style="font-size: 12px;">–¢–≤–æ–π —Ä–µ–∫–æ—Ä–¥: ${gameState.highScore}m</p>
                    </div>
                `;
            }
        } catch (e) {
            tg = null;
            console.log("–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ - –±–µ–∑ Telegram");
        }

        // Phaser –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const config = {
            type: Phaser.AUTO,
            width: window.innerWidth,
            height: window.innerHeight,
            parent: 'gameContainer',
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: CONFIG.GRAVITY },
                    debug: false
                }
            },
            scene: {
                preload: preload,
                create: create,
                update: update
            },
            backgroundColor: 0x0a0a1a
        };

        let game;
        let player;
        let obstacles;
        let dataItems;
        let ground;
        let cursors;
        let distanceText;
        let dataText;
        let speedText;
        let livesText;
        let score = 0;
        let gameSpeed = 1;
        let isSliding = false;
        let lastObstacleTime = 0;

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Å—Å–µ—Ç–æ–≤
        function preload() {
            // –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—É—é –≥—Ä–∞—Ñ–∏–∫—É –≤–º–µ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
            this.createPlayerGraphics();
            this.createObstacleGraphics();
            this.createDataGraphics();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
        function create() {
            // –°–æ–∑–¥–∞–µ–º –∑–µ–º–ª—é
            ground = this.add.rectangle(
                config.width / 2, 
                config.height - CONFIG.GROUND_HEIGHT / 2,
                config.width, 
                CONFIG.GROUND_HEIGHT,
                0x004466
            );
            
            this.physics.add.existing(ground, true);
            
            // –°–æ–∑–¥–∞–µ–º –∏–≥—Ä–æ–∫–∞
            player = this.physics.add.sprite(100, config.height - 150, 'player');
            player.setCollideWorldBounds(true);
            player.body.setSize(40, 60);
            player.setBounce(0.2);
            
            // –ì—Ä—É–ø–ø—ã –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤
            obstacles = this.physics.add.group();
            dataItems = this.physics.add.group();
            
            // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
            this.physics.add.collider(player, ground);
            this.physics.add.overlap(player, obstacles, hitObstacle, null, this);
            this.physics.add.overlap(player, dataItems, collectData, null, this);
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            cursors = this.input.keyboard.createCursorKeys();
            
            // –°–µ–Ω—Å–æ—Ä–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            this.input.on('pointerdown', () => {
                if (player.body.touching.down) {
                    player.setVelocityY(CONFIG.JUMP_FORCE);
                    showNotification("–ü–†–´–ñ–û–ö!");
                }
            });
            
            // UI —ç–ª–µ–º–µ–Ω—Ç—ã
            distanceText = this.add.text(20, 20, '–î–∏—Å—Ç–∞–Ω—Ü–∏—è: 0m', {
                fontSize: '20px',
                fill: '#00ffea',
                fontFamily: 'Courier New'
            });
            
            dataText = this.add.text(20, 50, '–î–∞–Ω–Ω—ã–µ: 0 GB', {
                fontSize: '20px',
                fill: '#ff00ff',
                fontFamily: 'Courier New'
            });
            
            speedText = this.add.text(20, 80, '–°–∫–æ—Ä–æ—Å—Ç—å: x1.0', {
                fontSize: '20px',
                fill: '#ff6b00',
                fontFamily: 'Courier New'
            });
            
            livesText = this.add.text(20, 110, '–ñ–∏–∑–Ω–∏: 3 ‚ù§Ô∏è', {
                fontSize: '20px',
                fill: '#ff3366',
                fontFamily: 'Courier New'
            });
            
            // –ù–∞—á–∞–ª—å–Ω—ã–π —Å–ø–∞–≤–Ω –æ–±—ä–µ–∫—Ç–æ–≤
            this.time.addEvent({
                delay: 1000,
                callback: spawnObstacle,
                callbackScope: this,
                loop: true
            });
            
            this.time.addEvent({
                delay: 500,
                callback: spawnData,
                callbackScope: this,
                loop: true
            });
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
            this.time.addEvent({
                delay: 10000,
                callback: increaseSpeed,
                callbackScope: this,
                loop: true
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã
        function update(time) {
            if (!gameState.isPlaying) return;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
            gameState.distance += Math.floor(gameSpeed);
            distanceText.setText('–î–∏—Å—Ç–∞–Ω—Ü–∏—è: ' + gameState.distance + 'm');
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
            if (cursors.space.isDown && player.body.touching.down) {
                player.setVelocityY(CONFIG.JUMP_FORCE);
            }
            
            // –°–ª–∞–π–¥ (—É–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç—Ä–µ–ª–∫–∏ –≤–Ω–∏–∑)
            if (cursors.down.isDown && player.body.touching.down && !isSliding) {
                isSliding = true;
                player.body.setSize(40, 30);
                player.setY(player.y + 15);
            } else if (!cursors.down.isDown && isSliding) {
                isSliding = false;
                player.body.setSize(40, 60);
                player.setY(player.y - 15);
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
            obstacles.getChildren().forEach(obstacle => {
                obstacle.x -= CONFIG.OBSTACLE_SPEED * gameSpeed;
                if (obstacle.x < -50) {
                    obstacle.destroy();
                }
            });
            
            // –î–≤–∏–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
            dataItems.getChildren().forEach(data => {
                data.x -= CONFIG.OBSTACLE_SPEED * gameSpeed * 0.8;
                data.rotation += 0.05;
                if (data.x < -50) {
                    data.destroy();
                }
            });
            
            // –°–ø–∞–≤–Ω –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π (—Ä–∞–Ω–¥–æ–º–Ω—ã–π)
            if (time > lastObstacleTime + 1000 / gameSpeed) {
                if (Math.random() > 0.7) {
                    spawnObstacle.call(this);
                }
                lastObstacleTime = time;
            }
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏–≥—Ä–æ–∫–∞
        function createPlayerGraphics() {
            const graphics = this.make.graphics({ x: 0, y: 0 }, false);
            
            // –¢–µ–ª–æ (–∫–∏–±–æ—Ä–≥)
            graphics.fillStyle(0x00ffea);
            graphics.fillRect(0, 0, 40, 60);
            
            // –ì–æ–ª–æ–≤–∞
            graphics.fillStyle(0xffffff);
            graphics.fillRect(10, 5, 20, 20);
            
            // –ì–ª–∞–∑–∞
            graphics.fillStyle(0xff00ff);
            graphics.fillRect(15, 10, 5, 5);
            graphics.fillRect(30, 10, 5, 5);
            
            // –ù–æ–≥–∏
            graphics.fillStyle(0xff6b00);
            graphics.fillRect(5, 55, 10, 10);
            graphics.fillRect(25, 55, 10, 10);
            
            graphics.generateTexture('player', 40, 60);
            graphics.destroy();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
        function createObstacleGraphics() {
            const graphics = this.make.graphics({ x: 0, y: 0 }, false);
            
            // –ë–∞—Ä—å–µ—Ä
            graphics.fillStyle(0xff3366);
            graphics.fillRect(0, 0, 50, 80);
            
            // –ù–µ–æ–Ω–æ–≤–æ–µ —Å–≤–µ—á–µ–Ω–∏–µ
            graphics.lineStyle(3, 0xff00ff, 1);
            graphics.strokeRect(2, 2, 46, 76);
            
            graphics.generateTexture('obstacle', 50, 80);
            graphics.destroy();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
        function createDataGraphics() {
            const graphics = this.make.graphics({ x: 0, y: 0 }, false);
            
            // –ñ–µ—Å—Ç–∫–∏–π –¥–∏—Å–∫
            graphics.fillStyle(0x00ffea);
            graphics.fillCircle(15, 15, 15);
            
            // –¶–µ–Ω—Ç—Ä
            graphics.fillStyle(0x000000);
            graphics.fillCircle(15, 15, 5);
            
            // –°–≤–µ—á–µ–Ω–∏–µ
            graphics.lineStyle(2, 0xffffff, 0.8);
            graphics.strokeCircle(15, 15, 17);
            
            graphics.generateTexture('data', 30, 30);
            graphics.destroy();
        }

        // –°–ø–∞–≤–Ω –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
        function spawnObstacle() {
            const obstacle = obstacles.create(
                config.width + 50,
                config.height - CONFIG.GROUND_HEIGHT - 40,
                'obstacle'
            );
            obstacle.setVelocityX(-CONFIG.OBSTACLE_SPEED * gameSpeed);
        }

        // –°–ø–∞–≤–Ω –¥–∞–Ω–Ω—ã—Ö
        function spawnData() {
            if (Math.random() < CONFIG.DATA_SPAWN_RATE) {
                const data = dataItems.create(
                    config.width + 50,
                    Phaser.Math.Between(100, config.height - 200),
                    'data'
                );
                data.setVelocityX(-CONFIG.OBSTACLE_SPEED * gameSpeed * 0.8);
            }
        }

        // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ–º
        function hitObstacle(player, obstacle) {
            obstacle.destroy();
            gameState.lives--;
            livesText.setText('–ñ–∏–∑–Ω–∏: ' + gameState.lives + ' ‚ù§Ô∏è');
            
            // –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è
            player.setTint(0xff0000);
            this.time.delayedCall(200, () => {
                player.clearTint();
            });
            
            showNotification("–°–¢–û–õ–ö–ù–û–í–ï–ù–ò–ï! -1 –∂–∏–∑–Ω—å");
            
            if (gameState.lives <= 0) {
                gameOver();
            }
        }

        // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
        function collectData(player, data) {
            data.destroy();
            gameState.dataCollected++;
            gameState.score += 100 * gameSpeed;
            dataText.setText('–î–∞–Ω–Ω—ã–µ: ' + gameState.dataCollected + ' GB');
            
            // –≠—Ñ—Ñ–µ–∫—Ç —Å–±–æ—Ä–∞
            player.setTint(0x00ff00);
            this.time.delayedCall(100, () => {
                player.clearTint();
            });
            
            // –°–ª—É—á–∞–π–Ω—ã–π –±–æ–Ω—É—Å
            if (Math.random() > 0.8) {
                gameState.lives = Math.min(5, gameState.lives + 1);
                livesText.setText('–ñ–∏–∑–Ω–∏: ' + gameState.lives + ' ‚ù§Ô∏è');
                showNotification("–ë–û–ù–£–°: +1 –∂–∏–∑–Ω—å!");
            }
        }

        // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏
        function increaseSpeed() {
            gameSpeed += 0.1;
            gameState.speed = gameSpeed.toFixed(1);
            speedText.setText('–°–∫–æ—Ä–æ—Å—Ç—å: x' + gameState.speed);
            showNotification("–°–ö–û–†–û–°–¢–¨ –£–í–ï–õ–ò–ß–ï–ù–ê!");
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(text) {
            const notification = document.getElementById('notification');
            notification.textContent = text;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 1500);
        }

        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        function gameOver() {
            gameState.isPlaying = false;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∫–æ—Ä–¥
            if (gameState.distance > gameState.highScore) {
                gameState.highScore = gameState.distance;
                localStorage.setItem('cyberHighScore', gameState.highScore);
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            this.add.text(config.width / 2, config.height / 2 - 50, '–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê!', {
                fontSize: '40px',
                fill: '#ff3366',
                fontFamily: 'Courier New'
            }).setOrigin(0.5);
            
            this.add.text(config.width / 2, config.height / 2, `–î–∏—Å—Ç–∞–Ω—Ü–∏—è: ${gameState.distance}m`, {
                fontSize: '30px',
                fill: '#00ffea',
                fontFamily: 'Courier New'
            }).setOrigin(0.5);
            
            this.add.text(config.width / 2, config.height / 2 + 40, `–°–æ–±—Ä–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö: ${gameState.dataCollected}GB`, {
                fontSize: '30px',
                fill: '#ff00ff',
                fontFamily: 'Courier New'
            }).setOrigin(0.5);
            
            this.add.text(config.width / 2, config.height / 2 + 80, `–†–µ–∫–æ—Ä–¥: ${gameState.highScore}m`, {
                fontSize: '25px',
                fill: '#ff6b00',
                fontFamily: 'Courier New'
            }).setOrigin(0.5);
            
            // –ö–Ω–æ–ø–∫–∞ —Ä–µ—Å—Ç–∞—Ä—Ç–∞
            const restartBtn = this.add.text(config.width / 2, config.height / 2 + 140, '–ò–ì–†–ê–¢–¨ –°–ù–û–í–ê', {
                fontSize: '30px',
                fill: '#ffffff',
                backgroundColor: '#ff00ff',
                padding: { x: 20, y: 10 },
                fontFamily: 'Courier New'
            }).setOrigin(0.5).setInteractive();
            
            restartBtn.on('pointerdown', () => {
                this.scene.restart();
                startGame();
            });
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Telegram
            if (tg && tg.sendData) {
                try {
                    tg.sendData(JSON.stringify({
                        action: 'game_complete',
                        score: gameState.distance,
                        data: gameState.dataCollected,
                        highScore: gameState.highScore
                    }));
                } catch (e) {}
            }
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        function startGame() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('gameStats').style.display = 'block';
            document.getElementById('gameControls').style.display = 'flex';
            
            gameState.isPlaying = true;
            gameState.distance = 0;
            gameState.dataCollected = 0;
            gameState.lives = 3;
            gameState.speed = 1.0;
            gameSpeed = 1.0;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.getElementById('distance').textContent = '0';
            document.getElementById('data').textContent = '0';
            document.getElementById('speed').textContent = 'x1.0';
            document.getElementById('lives').textContent = '3';
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
            document.getElementById('jumpBtn').addEventListener('touchstart', (e) => {
                e.preventDefault();
                if (player && player.body.touching.down) {
                    player.setVelocityY(CONFIG.JUMP_FORCE);
                }
            });
            
            document.getElementById('slideBtn').addEventListener('touchstart', (e) => {
                e.preventDefault();
                if (player && player.body.touching.down && !isSliding) {
                    isSliding = true;
                    player.body.setSize(40, 30);
                    player.setY(player.y + 15);
                }
            });
            
            document.getElementById('slideBtn').addEventListener('touchend', () => {
                if (isSliding) {
                    isSliding = false;
                    player.body.setSize(40, 60);
                    player.setY(player.y - 15);
                }
            });
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º Phaser –∏–≥—Ä—É
            if (!game) {
                game = new Phaser.Game(config);
            } else {
                game.scene.start('default');
            }
        }

        // –†–µ—Å–∞–π–∑ –ø—Ä–∏ –ø–æ–≤–æ—Ä–æ—Ç–µ —ç–∫—Ä–∞–Ω–∞
        window.addEventListener('resize', () => {
            if (game) {
                game.scale.resize(window.innerWidth, window.innerHeight);
            }
        });

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∫–æ—Ä–¥ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            if (gameState.highScore > 0) {
                document.getElementById('startScreen').innerHTML += `
                    <div style="margin-top: 20px; padding: 10px; background: rgba(255,0,255,0.2); border-radius: 10px;">
                        <p>üèÜ –õ—É—á—à–∏–π —Ä–µ–∫–æ—Ä–¥: ${gameState.highScore}m</p>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
