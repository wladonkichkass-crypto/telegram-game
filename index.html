<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∏—Ü–µ–ª–∏–π-68: –û–±–æ—Ä–æ–Ω–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #0a0a1a;
            color: #00ff88;
            font-family: 'Courier New', monospace;
            overflow: hidden;
            position: relative;
        }
        
        /* –ò–ì–†–û–í–û–ï –ü–û–õ–ï */
        #gameContainer {
            width: 100%;
            height: 100vh;
            position: relative;
            background: 
                linear-gradient(rgba(10, 10, 26, 0.9), rgba(10, 10, 26, 0.9)),
                url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" opacity="0.1"><path d="M20,50 Q40,30 60,50 T100,50" stroke="%2300ff88" fill="none"/><circle cx="30" cy="30" r="2" fill="%2300ff88"/><circle cx="70" cy="70" r="2" fill="%2300ff88"/></svg>');
            border: 3px solid #00ff88;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.3);
        }
        
        /* –õ–ê–ë–û–†–ê–¢–û–†–ò–Ø (–ë–ê–ó–ê) */
        #base {
            position: absolute;
            bottom: 50px;
            left: 50px;
            width: 120px;
            height: 100px;
            background: linear-gradient(45deg, #1a3a2a, #2a5a4a);
            border: 3px solid #00ff88;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            z-index: 100;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 136, 0.5); }
            50% { box-shadow: 0 0 40px rgba(0, 255, 136, 0.8); }
        }
        
        /* –ò–ì–†–û–ö (–ì–ï–†–û–ô) */
        .player {
            position: absolute;
            width: 40px;
            height: 40px;
            background: #00ff88;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            z-index: 50;
            transition: all 0.1s;
            box-shadow: 0 0 10px #00ff88;
            cursor: pointer;
            user-select: none;
        }
        
        .player::after {
            content: '';
            position: absolute;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid rgba(0, 255, 136, 0.3);
            animation: ripple 1.5s infinite;
        }
        
        @keyframes ripple {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(1.5); opacity: 0; }
        }
        
        /* –í–†–ê–ì–ò */
        .enemy {
            position: absolute;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            z-index: 40;
            transition: transform 0.3s;
        }
        
        .enemy.mushroom {
            background: radial-gradient(circle, #ff3366, #cc0044);
            box-shadow: 0 0 15px #ff3366;
        }
        
        .enemy.vine {
            background: radial-gradient(circle, #00cc66, #008844);
            box-shadow: 0 0 15px #00cc66;
        }
        
        .enemy.spore {
            background: radial-gradient(circle, #ffaa00, #cc8800);
            box-shadow: 0 0 15px #ffaa00;
        }
        
        .enemy.hit {
            animation: hit 0.3s;
        }
        
        @keyframes hit {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        
        /* –ü–£–õ–ò/–í–´–°–¢–†–ï–õ–´ */
        .bullet {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #00ff88;
            border-radius: 50%;
            box-shadow: 0 0 10px #00ff88;
            z-index: 45;
        }
        
        .spore-shot {
            background: #ffaa00;
            box-shadow: 0 0 10px #ffaa00;
        }
        
        .electric-shot {
            background: #00ccff;
            box-shadow: 0 0 10px #00ccff;
        }
        
        /* –ò–ù–¢–ï–†–§–ï–ô–° */
        #ui {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #00ff88;
            min-width: 250px;
            z-index: 1000;
        }
        
        .stat {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 16px;
        }
        
        .stat-value {
            color: #00ff88;
            font-weight: bold;
        }
        
        .health-bar {
            width: 100%;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00cc66);
            width: 100%;
            transition: width 0.5s;
        }
        
        .wave-info {
            text-align: center;
            margin: 15px 0;
            font-size: 18px;
            color: #ffaa00;
            animation: glow 1s infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 0 0 5px #ffaa00; }
            to { text-shadow: 0 0 15px #ffaa00; }
        }
        
        /* –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø */
        #controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: grid;
            grid-template-columns: repeat(3, 60px);
            gap: 10px;
            z-index: 1000;
        }
        
        .control-btn {
            width: 60px;
            height: 60px;
            background: rgba(0, 255, 136, 0.2);
            border: 2px solid #00ff88;
            border-radius: 10px;
            color: #00ff88;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .control-btn:hover {
            background: rgba(0, 255, 136, 0.4);
            transform: scale(1.1);
        }
        
        .control-btn:active {
            transform: scale(0.95);
        }
        
        .control-btn.upgrade {
            background: rgba(255, 170, 0, 0.2);
            border-color: #ffaa00;
            color: #ffaa00;
        }
        
        /* –°–ü–û–°–û–ë–ù–û–°–¢–ò */
        #abilities {
            position: absolute;
            bottom: 100px;
            right: 20px;
            display: flex;
            gap: 10px;
        }
        
        .ability {
            width: 70px;
            height: 70px;
            background: rgba(0, 204, 255, 0.2);
            border: 2px solid #00ccff;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #00ccff;
            font-size: 30px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .ability.cooldown {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .ability-cooldown {
            position: absolute;
            bottom: 5px;
            font-size: 12px;
        }
        
        /* –ú–ï–ù–Æ */
        #menu {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #00ff88;
            text-align: center;
            z-index: 2000;
            min-width: 300px;
            box-shadow: 0 0 50px rgba(0, 255, 136, 0.5);
        }
        
        #menu h1 {
            color: #00ff88;
            margin-bottom: 20px;
            font-size: 28px;
            text-shadow: 0 0 10px #00ff88;
        }
        
        .menu-btn {
            background: linear-gradient(45deg, #00ff88, #00cc66);
            border: none;
            color: black;
            padding: 15px 30px;
            margin: 10px 0;
            width: 100%;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .menu-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 255, 136, 0.4);
        }
        
        /* –≠–§–§–ï–ö–¢–´ */
        .explosion {
            position: absolute;
            width: 50px;
            height: 50px;
            background: radial-gradient(circle, #ffaa00, transparent 70%);
            border-radius: 50%;
            animation: explode 0.5s forwards;
            z-index: 60;
        }
        
        @keyframes explode {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
        
        .damage-text {
            position: absolute;
            color: #ff3366;
            font-weight: bold;
            font-size: 18px;
            animation: floatUp 1s forwards;
            z-index: 70;
            text-shadow: 2px 2px 0 black;
        }
        
        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }
        
        /* –î–û–†–û–ì–ò/–ü–£–¢–ò */
        .path {
            position: absolute;
            background: rgba(0, 255, 136, 0.1);
            border: 1px dashed rgba(0, 255, 136, 0.3);
        }
        
        /* –†–ï–°–£–†–°–´ */
        .resource {
            position: absolute;
            width: 25px;
            height: 25px;
            background: radial-gradient(circle, #ffaa00, #cc8800);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            animation: float 3s ease-in-out infinite;
            cursor: pointer;
            z-index: 30;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* –í–û–õ–ù–ê –í–†–ê–ì–û–í */
        .wave-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 20px 40px;
            border-radius: 10px;
            border: 3px solid #ffaa00;
            color: #ffaa00;
            font-size: 24px;
            font-weight: bold;
            z-index: 1000;
            animation: waveAlert 0.5s 3;
        }
        
        @keyframes waveAlert {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.1); }
        }
    </style>
</head>
<body>
    <!-- –ò–ì–†–û–í–û–ï –ü–û–õ–ï -->
    <div id="gameContainer">
        <!-- –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è (–±–∞–∑–∞) -->
        <div id="base">üè¢</div>
        
        <!-- –î–æ—Ä–æ–≥–∏ –¥–ª—è –≤—Ä–∞–≥–æ–≤ -->
        <div class="path" id="path1" style="width: 300px; height: 5px; top: 100px; left: 0;"></div>
        <div class="path" id="path2" style="width: 5px; height: 400px; top: 100px; left: 300px;"></div>
        <div class="path" id="path3" style="width: 200px; height: 5px; top: 500px; left: 300px;"></div>
        
        <!-- –ò–≥—Ä–æ–∫–∏, –≤—Ä–∞–≥–∏, –ø—É–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
    </div>
    
    <!-- –ò–ù–¢–ï–†–§–ï–ô–° -->
    <div id="ui">
        <div class="stat">
            <span>–í–æ–ª–Ω–∞:</span>
            <span class="stat-value" id="wave">1/10</span>
        </div>
        <div class="stat">
            <span>–í—Ä–∞–≥–æ–≤:</span>
            <span class="stat-value" id="enemiesCount">0</span>
        </div>
        <div class="stat">
            <span>–û–ø—ã—Ç:</span>
            <span class="stat-value" id="xp">0</span>
        </div>
        <div class="stat">
            <span>–°–ø–æ—Ä—ã:</span>
            <span class="stat-value" id="spores">1000</span>
        </div>
        
        <div style="margin: 15px 0;">
            <div style="display: flex; justify-content: space-between;">
                <span>–ó–¥–æ—Ä–æ–≤—å–µ –±–∞–∑—ã:</span>
                <span id="baseHealth">100/100</span>
            </div>
            <div class="health-bar">
                <div class="health-fill" id="baseHealthBar"></div>
            </div>
        </div>
        
        <div class="wave-info" id="waveInfo">–í–æ–ª–Ω–∞ 1 —á–µ—Ä–µ–∑: 5</div>
    </div>
    
    <!-- –°–ü–û–°–û–ë–ù–û–°–¢–ò -->
    <div id="abilities">
        <div class="ability" id="ability1" onclick="useAbility(1)">
            <div>‚ö°</div>
            <div class="ability-cooldown">5—Å</div>
        </div>
        <div class="ability" id="ability2" onclick="useAbility(2)">
            <div>üåÄ</div>
            <div class="ability-cooldown">10—Å</div>
        </div>
    </div>
    
    <!-- –ö–ù–û–ü–ö–ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
    <div id="controls">
        <div class="control-btn" onclick="upgradeDamage()" title="–£–ª—É—á—à–∏—Ç—å —É—Ä–æ–Ω">
            ‚öîÔ∏è
        </div>
        <div class="control-btn" onclick="upgradeSpeed()" title="–£–ª—É—á—à–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å">
            üèÉ
        </div>
        <div class="control-btn upgrade" onclick="buyPlayer()" title="–ö—É–ø–∏—Ç—å —É—á—ë–Ω–æ–≥–æ (500 —Å–ø–æ—Ä–æ–≤)">
            üë®‚Äçüî¨
        </div>
    </div>
    
    <!-- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
    <div id="menu">
        <h1>–ú–ò–¶–ï–õ–ò–ô-68</h1>
        <p style="margin-bottom: 20px; color: #00ff88;">–ó–∞—â–∏—Ç–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é –æ—Ç –≥—Ä–∏–±–Ω—ã—Ö –º—É—Ç–∞–Ω—Ç–æ–≤!</p>
        <button class="menu-btn" onclick="startGame()">‚ñ∂Ô∏è –ù–ê–ß–ê–¢–¨ –ò–ì–†–£</button>
        <button class="menu-btn" onclick="showInstructions()">üìñ –û–ë–£–ß–ï–ù–ò–ï</button>
        <div style="margin-top: 20px; color: #ffaa00;">
            –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –∫–ª–∏–∫–∞–π—Ç–µ –ø–æ –≤—Ä–∞–≥–∞–º –¥–ª—è –∞—Ç–∞–∫–∏
        </div>
    </div>
    
    <script>
        // =========== –ò–ì–†–û–í–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ===========
        let game = {
            running: false,
            wave: 1,
            maxWaves: 10,
            enemies: [],
            players: [],
            bullets: [],
            resources: [],
            effects: [],
            baseHealth: 100,
            maxBaseHealth: 100,
            spores: 1000,
            xp: 0,
            lastSpawn: 0,
            waveCooldown: 5,
            playerDamage: 10,
            playerAttackSpeed: 500,
            abilities: {
                lightning: { cooldown: 0, maxCooldown: 5000 },
                vortex: { cooldown: 0, maxCooldown: 10000 }
            }
        };
        
        let playerIdCounter = 1;
        
        // =========== –ó–í–£–ö–û–í–´–ï –≠–§–§–ï–ö–¢–´ (–ø—Ä–æ—Å—Ç–∞—è –∏–º–∏—Ç–∞—Ü–∏—è) ===========
        const sounds = {
            shoot: () => {
                // –ò–º–∏—Ç–∞—Ü–∏—è –∑–≤—É–∫–∞ –≤—ã—Å—Ç—Ä–µ–ª–∞
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.1);
            },
            
            explosion: () => {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 200;
                oscillator.type = 'sawtooth';
                
                gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + 0.3);
            }
        };
        
        // =========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ ===========
        function startGame() {
            game.running = true;
            document.getElementById('menu').style.display = 'none';
            resetGame();
            spawnInitialPlayers();
            startWaveTimer();
            gameLoop();
        }
        
        function resetGame() {
            game.wave = 1;
            game.baseHealth = 100;
            game.spores = 1000;
            game.xp = 0;
            game.enemies = [];
            game.bullets = [];
            game.resources = [];
            game.effects = [];
            
            updateUI();
            clearGameArea();
            
            // –°–æ–∑–¥–∞—ë–º –Ω–∞—á–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤
            spawnPlayer(100, 300);
            spawnPlayer(150, 350);
        }
        
        function spawnInitialPlayers() {
            // –ù–∞—á–∞–ª—å–Ω—ã–µ –∏–≥—Ä–æ–∫–∏ —Ä—è–¥–æ–º —Å –±–∞–∑–æ–π
            spawnPlayer(200, 200);
            spawnPlayer(250, 250);
        }
        
        // =========== –ò–ì–†–û–í–û–ô –¶–ò–ö–õ ===========
        function gameLoop() {
            if (!game.running) return;
            
            const now = Date.now();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–∞–≥–æ–≤
            updateEnemies();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É–ª—å
            updateBullets();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
            updateEffects();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
            updateResources();
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π
            updateAbilities();
            
            // –ê–≤—Ç–æ-–∞—Ç–∞–∫–∞ –∏–≥—Ä–æ–∫–æ–≤
            if (now - game.lastSpawn > game.playerAttackSpeed) {
                autoAttack();
                game.lastSpawn = now;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ü–∞ –≤–æ–ª–Ω—ã
            if (game.enemies.length === 0 && game.waveCooldown <= 0) {
                spawnWave();
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            updateUI();
            
            requestAnimationFrame(gameLoop);
        }
        
        // =========== –ò–ì–†–û–ö–ò ===========
        function spawnPlayer(x, y) {
            const player = {
                id: playerIdCounter++,
                x: x,
                y: y,
                element: null,
                target: null,
                lastAttack: 0,
                damage: game.playerDamage,
                attackSpeed: 1000
            };
            
            game.players.push(player);
            
            // –°–æ–∑–¥–∞—ë–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
            const elem = document.createElement('div');
            elem.className = 'player';
            elem.id = `player-${player.id}`;
            elem.textContent = 'üë®‚Äçüî¨';
            elem.style.left = `${x}px`;
            elem.style.top = `${y}px`;
            
            // –ö–ª–∏–∫ –ø–æ –∏–≥—Ä–æ–∫—É –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            elem.onclick = (e) => {
                e.stopPropagation();
                selectPlayer(player);
            };
            
            document.getElementById('gameContainer').appendChild(elem);
            player.element = elem;
            
            return player;
        }
        
        function selectPlayer(player) {
            // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞
            document.querySelectorAll('.player').forEach(p => {
                p.style.boxShadow = '0 0 10px #00ff88';
            });
            player.element.style.boxShadow = '0 0 20px #ffaa00';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∏–≥—Ä–æ–∫–µ
            console.log(`–ò–≥—Ä–æ–∫ ${player.id} –≤—ã–±—Ä–∞–Ω. –£—Ä–æ–Ω: ${player.damage}`);
        }
        
        function autoAttack() {
            game.players.forEach(player => {
                if (game.enemies.length > 0) {
                    // –ù–∞—Ö–æ–¥–∏–º –±–ª–∏–∂–∞–π—à–µ–≥–æ –≤—Ä–∞–≥–∞
                    let nearestEnemy = null;
                    let nearestDistance = Infinity;
                    
                    game.enemies.forEach(enemy => {
                        const dx = player.x - enemy.x;
                        const dy = player.y - enemy.y;
                        const distance = Math.sqrt(dx * dx + dy * dy);
                        
                        if (distance < nearestDistance && distance < 300) {
                            nearestDistance = distance;
                            nearestEnemy = enemy;
                        }
                    });
                    
                    if (nearestEnemy && Date.now() - player.lastAttack > player.attackSpeed) {
                        shootAt(player, nearestEnemy);
                        player.lastAttack = Date.now();
                    }
                }
            });
        }
        
        // =========== –í–†–ê–ì–ò ===========
        function spawnEnemy(type, pathIndex = 0) {
            const enemyTypes = {
                mushroom: { emoji: 'üçÑ', health: 30, speed: 1, damage: 5, color: 'mushroom' },
                vine: { emoji: 'üåø', health: 50, speed: 0.7, damage: 8, color: 'vine' },
                spore: { emoji: 'ü¶†', health: 20, speed: 1.5, damage: 3, color: 'spore' }
            };
            
            const typeData = enemyTypes[type] || enemyTypes.mushroom;
            
            const enemy = {
                id: Date.now() + Math.random(),
                type: type,
                emoji: typeData.emoji,
                x: -50,
                y: 100 + pathIndex * 60,
                health: typeData.health,
                maxHealth: typeData.health,
                speed: typeData.speed,
                damage: typeData.damage,
                pathIndex: pathIndex,
                element: null
            };
            
            game.enemies.push(enemy);
            
            // –°–æ–∑–¥–∞—ë–º –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
            const elem = document.createElement('div');
            elem.className = `enemy ${enemy.color}`;
            elem.id = `enemy-${enemy.id}`;
            elem.textContent = enemy.emoji;
            elem.style.left = `${enemy.x}px`;
            elem.style.top = `${enemy.y}px`;
            
            // –ö–ª–∏–∫ –ø–æ –≤—Ä–∞–≥—É –¥–ª—è –∞—Ç–∞–∫–∏
            elem.onclick = (e) => {
                e.stopPropagation();
                attackEnemy(enemy);
            };
            
            document.getElementById('gameContainer').appendChild(elem);
            enemy.element = elem;
            
            return enemy;
        }
        
        function updateEnemies() {
            game.enemies = game.enemies.filter(enemy => {
                // –î–≤–∏–∂–µ–Ω–∏–µ –∫ –±–∞–∑–µ
                if (enemy.x < 300) {
                    enemy.x += enemy.speed;
                } else if (enemy.y < 500) {
                    enemy.y += enemy.speed;
                } else if (enemy.x > 50) {
                    enemy.x -= enemy.speed;
                } else {
                    // –í—Ä–∞–≥ –¥–æ—Å—Ç–∏–≥ –±–∞–∑—ã
                    attackBase(enemy);
                    return false;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é
                enemy.element.style.left = `${enemy.x}px`;
                enemy.element.style.top = `${enemy.y}px`;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–¥–æ—Ä–æ–≤—å–µ
                if (enemy.health <= 0) {
                    killEnemy(enemy);
                    return false;
                }
                
                return true;
            });
        }
        
        function attackEnemy(enemy) {
            // –†—É—á–Ω–∞—è –∞—Ç–∞–∫–∞ –ø–æ –≤—Ä–∞–≥—É (–∫–ª–∏–∫)
            createBullet(
                enemy.x + 20,
                enemy.y + 20,
                enemy.x,
                enemy.y,
                'spore-shot'
            );
            
            enemy.health -= game.playerDamage * 2; // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–Ω –∑–∞ —Ä—É—á–Ω—É—é –∞—Ç–∞–∫—É
            
            // –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è
            enemy.element.classList.add('hit');
            setTimeout(() => {
                if (enemy.element) enemy.element.classList.remove('hit');
            }, 300);
            
            // –¢–µ–∫—Å—Ç —É—Ä–æ–Ω–∞
            showDamage(enemy.x, enemy.y, game.playerDamage * 2);
            
            // –ó–≤—É–∫
            sounds.shoot();
            
            // –ï—Å–ª–∏ –≤—Ä–∞–≥ —É–±–∏—Ç
            if (enemy.health <= 0) {
                killEnemy(enemy);
            }
        }
        
        function killEnemy(enemy) {
            // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç
            if (enemy.element && enemy.element.parentNode) {
                enemy.element.parentNode.removeChild(enemy.element);
            }
            
            // –ù–∞–≥—Ä–∞–¥–∞
            const xpReward = enemy.type === 'mushroom' ? 10 : 
                            enemy.type === 'vine' ? 20 : 5;
            game.xp += xpReward;
            game.spores += xpReward * 5;
            
            // –≠—Ñ—Ñ–µ–∫—Ç –≤–∑—Ä—ã–≤–∞
            createExplosion(enemy.x, enemy.y);
            
            // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–ø–∞–¥ —Ä–µ—Å—É—Ä—Å–∞
            if (Math.random() > 0.7) {
                createResource(enemy.x, enemy.y);
            }
            
            // –ó–≤—É–∫
            sounds.explosion();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç—á–∏–∫
            updateUI();
        }
        
        function attackBase(enemy) {
            game.baseHealth -= enemy.damage;
            createExplosion(50, 550); // –≠—Ñ—Ñ–µ–∫—Ç —É –±–∞–∑—ã
            
            if (game.baseHealth <= 0) {
                gameOver();
            }
            
            updateUI();
        }
        
        // =========== –í–û–õ–ù–´ –í–†–ê–ì–û–í ===========
        function startWaveTimer() {
            game.waveCooldown = 5;
            
            const timer = setInterval(() => {
                game.waveCooldown--;
                document.getElementById('waveInfo').textContent = 
                    `–í–æ–ª–Ω–∞ ${game.wave} —á–µ—Ä–µ–∑: ${game.waveCooldown}`;
                
                if (game.waveCooldown <= 0) {
                    clearInterval(timer);
                    spawnWave();
                }
            }, 1000);
        }
        
        function spawnWave() {
            showWaveAlert(`–í–û–õ–ù–ê ${game.wave} –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø!`);
            
            const enemyCount = 5 + game.wave * 2;
            const enemyTypes = ['mushroom', 'vine', 'spore'];
            
            for (let i = 0; i < enemyCount; i++) {
                setTimeout(() => {
                    const type = enemyTypes[Math.floor(Math.random() * enemyTypes.length)];
                    spawnEnemy(type, i % 3);
                }, i * 500);
            }
            
            game.wave++;
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä —Å–ª–µ–¥—É—é—â–µ–π –≤–æ–ª–Ω—ã
            if (game.wave <= game.maxWaves) {
                setTimeout(() => {
                    game.waveCooldown = 10 + game.wave;
                    startWaveTimer();
                }, enemyCount * 500 + 5000);
            } else {
                victory();
            }
        }
        
        // =========== –°–¢–†–ï–õ–¨–ë–ê ===========
        function shootAt(shooter, target) {
            const bulletX = shooter.x + 20;
            const bulletY = shooter.y + 20;
            
            createBullet(bulletX, bulletY, target.x, target.y);
        }
        
        function createBullet(fromX, fromY, toX, toY, type = 'normal') {
            const bullet = {
                id: Date.now() + Math.random(),
                x: fromX,
                y: fromY,
                targetX: toX,
                targetY: toY,
                speed: 10,
                type: type,
                element: null
            };
            
            game.bullets.push(bullet);
            
            const elem = document.createElement('div');
            elem.className = `bullet ${type === 'spore-shot' ? 'spore-shot' : 
                              type === 'electric' ? 'electric-shot' : ''}`;
            elem.style.left = `${bullet.x}px`;
            elem.style.top = `${bullet.y}px`;
            
            document.getElementById('gameContainer').appendChild(elem);
            bullet.element = elem;
            
            return bullet;
        }
        
        function updateBullets() {
            game.bullets = game.bullets.filter(bullet => {
                // –î–≤–∏–∂–µ–Ω–∏–µ –∫ —Ü–µ–ª–∏
                const dx = bullet.targetX - bullet.x;
                const dy = bullet.targetY - bullet.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < bullet.speed) {
                    // –ü—É–ª—è –¥–æ—Å—Ç–∏–≥–ª–∞ —Ü–µ–ª–∏
                    hitTarget(bullet.x, bullet.y);
                    if (bullet.element.parentNode) {
                        bullet.element.parentNode.removeChild(bullet.element);
                    }
                    return false;
                }
                
                // –î–≤–∏–≥–∞–µ–º –ø—É–ª—é
                bullet.x += (dx / distance) * bullet.speed;
                bullet.y += (dy / distance) * bullet.speed;
                
                bullet.element.style.left = `${bullet.x}px`;
                bullet.element.style.top = `${bullet.y}px`;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –≤—Ä–∞–≥–∞–º–∏
                game.enemies.forEach(enemy => {
                    const enemyX = enemy.x + 17.5;
                    const enemyY = enemy.y + 17.5;
                    const bulletX = bullet.x + 4;
                    const bulletY = bullet.y + 4;
                    
                    const dist = Math.sqrt(
                        Math.pow(enemyX - bulletX, 2) + 
                        Math.pow(enemyY - bulletY, 2)
                    );
                    
                    if (dist < 25) { // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ
                        enemy.health -= bullet.type === 'electric' ? 30 : 
                                       bullet.type === 'spore-shot' ? 15 : 10;
                        
                        if (bullet.element.parentNode) {
                            bullet.element.parentNode.removeChild(bullet.element);
                        }
                        
                        if (enemy.health <= 0) {
                            killEnemy(enemy);
                        } else {
                            enemy.element.classList.add('hit');
                            setTimeout(() => {
                                if (enemy.element) enemy.element.classList.remove('hit');
                            }, 300);
                            
                            showDamage(enemy.x, enemy.y, 
                                bullet.type === 'electric' ? 30 : 
                                bullet.type === 'spore-shot' ? 15 : 10);
                        }
                        
                        return false;
                    }
                });
                
                return true;
            });
        }
        
        function hitTarget(x, y) {
            createExplosion(x, y);
        }
        
        // =========== –°–ü–û–°–û–ë–ù–û–°–¢–ò ===========
        function useAbility(abilityNum) {
            const now = Date.now();
            
            if (abilityNum === 1 && game.abilities.lightning.cooldown <= now) {
                // –ú–æ–ª–Ω–∏—è - –ø–æ—Ä–∞–∂–∞–µ—Ç –≤—Å–µ—Ö –≤—Ä–∞–≥–æ–≤ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
                game.enemies.forEach(enemy => {
                    enemy.health -= 30;
                    createBullet(
                        Math.random() * window.innerWidth,
                        0,
                        enemy.x,
                        enemy.y,
                        'electric'
                    );
                    
                    if (enemy.health <= 0) {
                        killEnemy(enemy);
                    }
                });
                
                game.abilities.lightning.cooldown = now + game.abilities.lightning.maxCooldown;
                document.getElementById('ability1').classList.add('cooldown');
                
            } else if (abilityNum === 2 && game.abilities.vortex.cooldown <= now) {
                // –í–∏—Ö—Ä—å - –ø—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç –≤—Ä–∞–≥–æ–≤ –∏ –Ω–∞–Ω–æ—Å–∏—Ç —É—Ä–æ–Ω
                game.enemies.forEach(enemy => {
                    enemy.x -= 100;
                    enemy.health -= 20;
                    
                    if (enemy.health <= 0) {
                        killEnemy(enemy);
                    } else {
                        showDamage(enemy.x, enemy.y, 20);
                    }
                });
                
                game.abilities.vortex.cooldown = now + game.abilities.vortex.maxCooldown;
                document.getElementById('ability2').classList.add('cooldown');
                
                createExplosion(window.innerWidth / 2, window.innerHeight / 2);
            }
        }
        
        function updateAbilities() {
            const now = Date.now();
            
            // –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å 1
            if (game.abilities.lightning.cooldown > now) {
                const remaining = Math.ceil((game.abilities.lightning.cooldown - now) / 1000);
                document.querySelector('#ability1 .ability-cooldown').textContent = `${remaining}—Å`;
            } else {
                document.getElementById('ability1').classList.remove('cooldown');
                document.querySelector('#ability1 .ability-cooldown').textContent = '‚ö°';
            }
            
            // –°–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å 2
            if (game.abilities.vortex.cooldown > now) {
                const remaining = Math.ceil((game.abilities.vortex.cooldown - now) / 1000);
                document.querySelector('#ability2 .ability-cooldown').textContent = `${remaining}—Å`;
            } else {
                document.getElementById('ability2').classList.remove('cooldown');
                document.querySelector('#ability2 .ability-cooldown').textContent = 'üåÄ';
            }
        }
        
        // =========== –†–ï–°–£–†–°–´ ===========
        function createResource(x, y) {
            const resource = {
                id: Date.now() + Math.random(),
                x: x,
                y: y,
                type: 'spore',
                value: 50,
                element: null
            };
            
            game.resources.push(resource);
            
            const elem = document.createElement('div');
            elem.className = 'resource';
            elem.textContent = 'üçÑ';
            elem.style.left = `${x}px`;
            elem.style.top = `${y}px`;
            elem.onclick = () => collectResource(resource);
            
            document.getElementById('gameContainer').appendChild(elem);
            resource.element = elem;
            
            // –ê–≤—Ç–æ-—Å–±–æ—Ä —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (resource.element && resource.element.parentNode) {
                    resource.element.parentNode.removeChild(resource.element);
                    game.resources = game.resources.filter(r => r.id !== resource.id);
                }
            }, 10000);
        }
        
        function updateResources() {
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä —Ä–µ—Å—É—Ä—Å–æ–≤ –∏–≥—Ä–æ–∫–∞–º–∏
            game.players.forEach(player => {
                game.resources.forEach(resource => {
                    const dx = player.x - resource.x;
                    const dy = player.y - resource.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < 50 && resource.element && resource.element.parentNode) {
                        collectResource(resource);
                    }
                });
            });
        }
        
        function collectResource(resource) {
            game.spores += resource.value;
            
            // –≠—Ñ—Ñ–µ–∫—Ç —Å–±–æ—Ä–∞
            const effect = document.createElement('div');
            effect.className = 'damage-text';
            effect.textContent = `+${resource.value}`;
            effect.style.left = `${resource.x}px`;
            effect.style.top = `${resource.y}px`;
            effect.style.color = '#ffaa00';
            
            document.getElementById('gameContainer').appendChild(effect);
            setTimeout(() => {
                if (effect.parentNode) effect.parentNode.removeChild(effect);
            }, 1000);
            
            // –£–¥–∞–ª—è–µ–º —Ä–µ—Å—É—Ä—Å
            if (resource.element && resource.element.parentNode) {
                resource.element.parentNode.removeChild(resource.element);
            }
            
            game.resources = game.resources.filter(r => r.id !== resource.id);
            updateUI();
        }
        
        // =========== –≠–§–§–ï–ö–¢–´ ===========
        function createExplosion(x, y) {
            const explosion = {
                id: Date.now() + Math.random(),
                x: x,
                y: y,
                element: null
            };
            
            game.effects.push(explosion);
            
            const elem = document.createElement('div');
            elem.className = 'explosion';
            elem.style.left = `${x - 25}px`;
            elem.style.top = `${y - 25}px`;
            
            document.getElementById('gameContainer').appendChild(elem);
            explosion.element = elem;
            
            // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 0.5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (elem.parentNode) elem.parentNode.removeChild(elem);
                game.effects = game.effects.filter(e => e.id !== explosion.id);
            }, 500);
        }
        
        function showDamage(x, y, damage) {
            const damageText = document.createElement('div');
            damageText.className = 'damage-text';
            damageText.textContent = `-${damage}`;
            damageText.style.left = `${x}px`;
            damageText.style.top = `${y}px`;
            
            document.getElementById('gameContainer').appendChild(damageText);
            
            setTimeout(() => {
                if (damageText.parentNode) {
                    damageText.parentNode.removeChild(damageText);
                }
            }, 1000);
        }
        
        function updateEffects() {
            // –≠—Ñ—Ñ–µ–∫—Ç—ã —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ —Ç–∞–π–º–µ—Ä—É
        }
        
        // =========== UI –ò –£–ü–†–ê–í–õ–ï–ù–ò–ï ===========
        function updateUI() {
            document.getElementById('wave').textContent = `${game.wave}/${game.maxWaves}`;
            document.getElementById('enemiesCount').textContent = game.enemies.length;
            document.getElementById('xp').textContent = game.xp;
            document.getElementById('spores').textContent = game.spores;
            document.getElementById('baseHealth').textContent = `${game.baseHealth}/${game.maxBaseHealth}`;
            document.getElementById('baseHealthBar').style.width = `${(game.baseHealth / game.maxBaseHealth) * 100}%`;
        }
        
        function upgradeDamage() {
            if (game.spores >= 200) {
                game.spores -= 200;
                game.playerDamage += 5;
                updateUI();
                
                // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç
                const effect = document.createElement('div');
                effect.className = 'damage-text';
                effect.textContent = '–£–†–û–ù +5';
                effect.style.left = '50%';
                effect.style.top = '50%';
                effect.style.color = '#00ff88';
                effect.style.fontSize = '24px';
                
                document.getElementById('gameContainer').appendChild(effect);
                setTimeout(() => {
                    if (effect.parentNode) effect.parentNode.removeChild(effect);
                }, 1000);
            }
        }
        
        function upgradeSpeed() {
            if (game.spores >= 150) {
                game.spores -= 150;
                game.playerAttackSpeed = Math.max(200, game.playerAttackSpeed - 100);
                updateUI();
            }
        }
        
        function buyPlayer() {
            if (game.spores >= 500 && game.players.length < 8) {
                game.spores -= 500;
                
                // –°–ø–∞–≤–Ω–∏–º –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ —Ä—è–¥–æ–º —Å –±–∞–∑–æ–π
                const x = 200 + Math.random() * 100;
                const y = 200 + Math.random() * 100;
                spawnPlayer(x, y);
                
                updateUI();
            }
        }
        
        // =========== –ò–ì–†–û–í–´–ï –°–û–ë–´–¢–ò–Ø ===========
        function showWaveAlert(text) {
            const alert = document.createElement('div');
            alert.className = 'wave-indicator';
            alert.textContent = text;
            
            document.getElementById('gameContainer').appendChild(alert);
            
            setTimeout(() => {
                if (alert.parentNode) alert.parentNode.removeChild(alert);
            }, 2000);
        }
        
        function gameOver() {
            game.running = false;
            
            const gameOverScreen = document.createElement('div');
            gameOverScreen.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.9);
                padding: 40px;
                border-radius: 15px;
                border: 3px solid #ff3366;
                text-align: center;
                color: #ff3366;
                z-index: 2000;
                min-width: 300px;
            `;
            
            gameOverScreen.innerHTML = `
                <h1 style="margin-bottom: 20px;">–õ–ê–ë–û–†–ê–¢–û–†–ò–Ø –£–ù–ò–ß–¢–û–ñ–ï–ù–ê</h1>
                <p style="margin-bottom: 20px; font-size: 18px;">
                    –í–æ–ª–Ω–∞: ${game.wave}<br>
                    –û–ø—ã—Ç: ${game.xp}<br>
                    –°–ø–æ—Ä—ã: ${game.spores}
                </p>
                <button class="menu-btn" onclick="location.reload()" 
                        style="background: #ff3366; color: white;">
                    üîÑ –ù–ê–ß–ê–¢–¨ –ó–ê–ù–û–í–û
                </button>
            `;
            
            document.getElementById('gameContainer').appendChild(gameOverScreen);
        }
        
        function victory() {
            game.running = false;
            
            const victoryScreen = document.createElement('div');
            victoryScreen.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.9);
                padding: 40px;
                border-radius: 15px;
                border: 3px solid #00ff88;
                text-align: center;
                color: #00ff88;
                z-index: 2000;
                min-width: 300px;
            `;
            
            victoryScreen.innerHTML = `
                <h1 style="margin-bottom: 20px;">üèÜ –ü–û–ë–ï–î–ê!</h1>
                <p style="margin-bottom: 20px; font-size: 18px;">
                    –í—ã –∑–∞—â–∏—Ç–∏–ª–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é!<br>
                    –í—Å–µ 10 –≤–æ–ª–Ω –æ—Ç—Ä–∞–∂–µ–Ω—ã!<br>
                    –ò—Ç–æ–≥–æ–≤—ã–π —Å—á—ë—Ç: ${game.xp}
                </p>
                <button class="menu-btn" onclick="location.reload()">
                    üéÆ –ò–ì–†–ê–¢–¨ –ï–©–Å
                </button>
            `;
            
            document.getElementById('gameContainer').appendChild(victoryScreen);
        }
        
        function showInstructions() {
            alert(`üéÆ –£–ü–†–ê–í–õ–ï–ù–ò–ï:
1. –ö–ª–∏–∫–∞–π—Ç–µ –ø–æ –≤—Ä–∞–≥–∞–º –¥–ª—è —Ä—É—á–Ω–æ–π –∞—Ç–∞–∫–∏
2. –£—á—ë–Ω—ã–µ –∞—Ç–∞–∫—É—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. –°–æ–±–∏—Ä–∞–π—Ç–µ –≤—ã–ø–∞–≤—à–∏–µ —Ä–µ—Å—É—Ä—Å—ã (–∫–ª–∏–∫)
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ (–∫–Ω–æ–ø–∫–∏ —Å–ø—Ä–∞–≤–∞)
5. –£–ª—É—á—à–∞–π—Ç–µ —É—á—ë–Ω—ã—Ö –∑–∞ —Å–ø–æ—Ä—ã

–¶–µ–ª—å: –∑–∞—â–∏—Ç–∏—Ç—å –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é 10 –≤–æ–ª–Ω –≤—Ä–∞–≥–æ–≤!`);
        }
        
        function clearGameArea() {
            document.querySelectorAll('.player, .enemy, .bullet, .resource, .explosion, .damage-text').forEach(el => {
                if (el.parentNode) el.parentNode.removeChild(el);
            });
            game.players = [];
        }
        
        // =========== –ó–ê–ü–£–°–ö ===========
        // –ö–ª–∏–∫ –ø–æ –∏–≥—Ä–æ–≤–æ–º—É –ø–æ–ª—é –¥–ª—è —Ä—É—á–Ω–æ–π –∞—Ç–∞–∫–∏
        document.getElementById('gameContainer').onclick = (e) => {
            if (!game.running) return;
            
            // –°–æ–∑–¥–∞—ë–º —ç—Ñ—Ñ–µ–∫—Ç –∫–ª–∏–∫–∞
            const clickEffect = document.createElement('div');
            clickEffect.style.cssText = `
                position: absolute;
                width: 20px;
                height: 20px;
                background: rgba(0, 255, 136, 0.5);
                border-radius: 50%;
                left: ${e.clientX - 10}px;
                top: ${e.clientY - 10}px;
                animation: explode 0.3s forwards;
            `;
            
            document.getElementById('gameContainer').appendChild(clickEffect);
            setTimeout(() => {
                if (clickEffect.parentNode) clickEffect.parentNode.removeChild(clickEffect);
            }, 300);
            
            sounds.shoot();
        };
    </script>
</body>
</html>
