<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –∑–∞—â–∏—Ç–Ω–∏–∫</title>
    <style>
        /* –°–ë–†–û–° –ò –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò */
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: fixed;
            background: #000;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        /* –≠–ö–†–ê–ù–´ */
        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            background: linear-gradient(135deg, #0a0a2a, #1a1a4a);
            color: white;
        }
        
        .screen.active {
            display: flex;
        }
        
        /* –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ */
        #menuScreen {
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }
        
        .logo {
            font-size: 32px;
            font-weight: bold;
            color: #00f7ff;
            text-shadow: 0 0 20px #00f7ff;
            margin-bottom: 10px;
        }
        
        .tagline {
            color: #aaa;
            margin-bottom: 40px;
            font-size: 16px;
        }
        
        .menu-button {
            width: 80%;
            max-width: 300px;
            padding: 18px;
            margin: 10px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(135deg, #0066ff, #0099ff);
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s;
            box-shadow: 0 5px 15px rgba(0, 102, 255, 0.4);
        }
        
        .menu-button:active {
            transform: scale(0.95);
        }
        
        .secondary-button {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        /* –ò–ì–†–û–í–û–ô –≠–ö–†–ê–ù */
        #gameScreen {
            padding: 10px;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            margin-bottom: 10px;
        }
        
        .stats {
            display: flex;
            gap: 20px;
        }
        
        .stat {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 18px;
            font-weight: bold;
        }
        
        .stat i {
            color: #ff3366;
        }
        
        /* –ò–ì–†–û–í–ê–Ø –û–ë–õ–ê–°–¢–¨ */
        #gameArea {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-bottom: 10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        #gameCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        /* –û–°–ù–û–í–ù–û–ï –£–ü–†–ê–í–õ–ï–ù–ò–ï (–¢–ê–ü –ò –•–û–õ–î) */
        #touchControls {
            position: absolute;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 30px;
            padding: 0 20px;
        }
        
        .touch-zone {
            width: 120px;
            height: 120px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            color: white;
            opacity: 0.7;
            transition: all 0.2s;
            border: 3px solid rgba(255, 255, 255, 0.2);
        }
        
        .touch-zone.active {
            background: rgba(0, 255, 255, 0.3);
            opacity: 1;
            transform: scale(1.1);
            border-color: #00ffff;
        }
        
        /* –ù–ò–ñ–ù–ò–ï –ö–ù–û–ü–ö–ò */
        .bottom-controls {
            display: flex;
            gap: 10px;
            padding: 10px;
        }
        
        .action-button {
            flex: 1;
            padding: 18px;
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            color: white;
        }
        
        #fireButton {
            background: linear-gradient(135deg, #ff3366, #ff0066);
            box-shadow: 0 5px 15px rgba(255, 51, 102, 0.4);
        }
        
        #fireButton:active {
            background: linear-gradient(135deg, #ff0066, #ff3366);
        }
        
        #menuButton {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        /* –ò–ù–°–¢–†–£–ö–¶–ò–ò */
        #howToScreen {
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 25px;
            margin: 20px;
            max-width: 400px;
        }
        
        .instruction-item {
            display: flex;
            align-items: center;
            margin: 15px 0;
            text-align: left;
        }
        
        .instruction-icon {
            width: 50px;
            height: 50px;
            background: rgba(0, 247, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 24px;
            color: #00f7ff;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-height: 700px) {
            .touch-zone {
                width: 100px;
                height: 100px;
                font-size: 28px;
            }
            
            .menu-button {
                padding: 15px;
            }
        }
        
        @media (max-height: 600px) {
            .touch-zone {
                width: 80px;
                height: 80px;
                font-size: 24px;
            }
            
            #touchControls {
                gap: 15px;
            }
            
            .action-button {
                padding: 15px;
                font-size: 16px;
            }
        }
        
        /* –ì–û–†–ò–ó–û–ù–¢–ê–õ–¨–ù–ê–Ø –û–†–ò–ï–ù–¢–ê–¶–ò–Ø */
        @media (orientation: landscape) {
            #gameScreen {
                flex-direction: row;
                padding: 10px;
            }
            
            .game-header {
                width: 200px;
                flex-direction: column;
                justify-content: flex-start;
                padding: 20px;
                margin-right: 10px;
                margin-bottom: 0;
            }
            
            .stats {
                flex-direction: column;
                gap: 30px;
            }
            
            #gameArea {
                margin-bottom: 0;
                margin-right: 10px;
            }
            
            #touchControls {
                position: absolute;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                width: 80%;
            }
            
            .bottom-controls {
                width: 200px;
                flex-direction: column;
            }
        }
        
        /* –û–ß–ï–ù–¨ –ú–ê–õ–ï–ù–¨–ö–ò–ï –≠–ö–†–ê–ù–´ */
        @media (max-width: 350px) {
            .logo {
                font-size: 24px;
            }
            
            .touch-zone {
                width: 70px;
                height: 70px;
                font-size: 20px;
            }
            
            .action-button {
                padding: 12px;
                font-size: 14px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
    <div id="menuScreen" class="screen active">
        <div class="logo">üöÄ –ö–û–°–ú–ò–ß–ï–°–ö–ò–ô –ó–ê–©–ò–¢–ù–ò–ö</div>
        <div class="tagline">–ó–∞—â–∏—Ç–∏ –ø–ª–∞–Ω–µ—Ç—É –æ—Ç –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤!</div>
        
        <button class="menu-button" onclick="showScreen('gameScreen')">
            <i class="fas fa-play"></i> –ù–ê–ß–ê–¢–¨ –ò–ì–†–£
        </button>
        
        <button class="menu-button secondary-button" onclick="showScreen('howToScreen')">
            <i class="fas fa-question-circle"></i> –ö–ê–ö –ò–ì–†–ê–¢–¨
        </button>
        
        <div style="margin-top: 40px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px; max-width: 300px;">
            <p><i class="fas fa-mobile-alt"></i> <strong>–°–æ–≤–µ—Ç:</strong></p>
            <p style="font-size: 14px; color: #00f7ff;">‚Ä¢ –¢–∞–ø–∞–π—Ç–µ –ø–æ –∑–æ–Ω–∞–º —Å–ª–µ–≤–∞/—Å–ø—Ä–∞–≤–∞ –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è</p>
            <p style="font-size: 14px; color: #00f7ff;">‚Ä¢ –ù–∞–∂–∏–º–∞–π—Ç–µ –û–ì–û–ù–¨ –¥–ª—è —Å—Ç—Ä–µ–ª—å–±—ã</p>
        </div>
    </div>

    <!-- –ò–ì–†–û–í–û–ô –≠–ö–†–ê–ù -->
    <div id="gameScreen" class="screen">
        <div class="game-header">
            <div class="stats">
                <div class="stat">
                    <i class="fas fa-heart"></i> <span id="lives">3</span>
                </div>
                <div class="stat">
                    <i class="fas fa-star"></i> <span id="score">0</span>
                </div>
                <div class="stat">
                    <i class="fas fa-clock"></i> <span id="time">60</span>—Å
                </div>
            </div>
        </div>
        
        <div id="gameArea">
            <canvas id="gameCanvas"></canvas>
            
            <!-- –°–ï–ù–°–û–†–ù–´–ï –ó–û–ù–´ –î–õ–Ø –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
            <div id="touchControls">
                <div class="touch-zone" id="leftZone">
                    <i class="fas fa-arrow-left"></i>
                </div>
                <div class="touch-zone" id="rightZone">
                    <i class="fas fa-arrow-right"></i>
                </div>
            </div>
        </div>
        
        <div class="bottom-controls">
            <button class="action-button" id="fireButton">
                <i class="fas fa-bolt"></i> –û–ì–û–ù–¨
            </button>
            <button class="action-button" id="menuButton" onclick="showScreen('menuScreen')">
                <i class="fas fa-home"></i> –ú–ï–ù–Æ
            </button>
        </div>
    </div>

    <!-- –≠–ö–†–ê–ù –ò–ù–°–¢–†–£–ö–¶–ò–ô -->
    <div id="howToScreen" class="screen">
        <div class="logo">üéÆ –ö–ê–ö –ò–ì–†–ê–¢–¨</div>
        
        <div class="instructions">
            <div class="instruction-item">
                <div class="instruction-icon">
                    <i class="fas fa-hand-point-left"></i>
                </div>
                <div>
                    <strong>–î–í–ò–ñ–ï–ù–ò–ï</strong>
                    <p>–¢–∞–ø–∞–π—Ç–µ –Ω–∞ –ª–µ–≤—É—é/–ø—Ä–∞–≤—É—é –∑–æ–Ω—ã<br>–¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ—Ä–∞–±–ª–µ–º</p>
                </div>
            </div>
            
            <div class="instruction-item">
                <div class="instruction-icon">
                    <i class="fas fa-bolt"></i>
                </div>
                <div>
                    <strong>–°–¢–†–ï–õ–¨–ë–ê</strong>
                    <p>–ù–∞–∂–∏–º–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É –û–ì–û–ù–¨<br>–¥–ª—è —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è –∞—Å—Ç–µ—Ä–æ–∏–¥–æ–≤</p>
                </div>
            </div>
            
            <div class="instruction-item">
                <div class="instruction-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <div>
                    <strong>–ñ–ò–ó–ù–ò</strong>
                    <p>–£ –≤–∞—Å 3 –∂–∏–∑–Ω–∏<br>–ò–∑–±–µ–≥–∞–π—Ç–µ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π!</p>
                </div>
            </div>
            
            <div class="instruction-item">
                <div class="instruction-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div>
                    <strong>–í–†–ï–ú–Ø</strong>
                    <p>–£–Ω–∏—á—Ç–æ–∂–∞–π—Ç–µ –∞—Å—Ç–µ—Ä–æ–∏–¥—ã –∑–∞ 60 —Å–µ–∫—É–Ω–¥</p>
                </div>
            </div>
        </div>
        
        <button class="menu-button" onclick="showScreen('menuScreen')">
            <i class="fas fa-arrow-left"></i> –ù–ê–ó–ê–î
        </button>
    </div>

    <script>
        // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –≠–ö–†–ê–ù–ê–ú–ò ==========
        function showScreen(screenId) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ —ç–∫—Ä–∞–Ω—ã
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω—ã–π —ç–∫—Ä–∞–Ω
            document.getElementById(screenId).classList.add('active');
            
            // –ï—Å–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω - –∑–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É
            if (screenId === 'gameScreen') {
                initGame();
            } else {
                // –ï—Å–ª–∏ —É—Ö–æ–¥–∏–º –∏–∑ –∏–≥—Ä—ã - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º
                if (window.gameLoopId) {
                    cancelAnimationFrame(window.gameLoopId);
                    window.gameLoopId = null;
                }
                if (window.asteroidInterval) {
                    clearInterval(window.asteroidInterval);
                    window.asteroidInterval = null;
                }
                if (window.timerInterval) {
                    clearInterval(window.timerInterval);
                    window.timerInterval = null;
                }
            }
        }

        // ========== –ò–ì–†–û–í–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
        let canvas, ctx;
        let player = {
            x: 0, y: 0,
            width: 40, height: 60,
            speed: 8
        };
        
        let bullets = [];
        let asteroids = [];
        let explosions = [];
        
        let score = 0;
        let lives = 3;
        let timeLeft = 60;
        let isPlaying = false;
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        let moveDirection = 0; // -1 = left, 0 = stop, 1 = right
        let leftZoneActive = false;
        let rightZoneActive = false;

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ ==========
        function initGame() {
            // –ü–æ–ª—É—á–∞–µ–º canvas
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä canvas
            resizeCanvas();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
            resetGame();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            setupControls();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
            startGameIntervals();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            isPlaying = true;
            gameLoop();
        }
        
        function resetGame() {
            // –°–±—Ä–æ—Å –ø–æ–∑–∏—Ü–∏–∏ –∏–≥—Ä–æ–∫–∞
            player.x = (canvas.width - player.width) / 2;
            player.y = canvas.height - player.height - 20;
            
            // –û—á–∏—â–∞–µ–º –º–∞—Å—Å–∏–≤—ã
            bullets = [];
            asteroids = [];
            explosions = [];
            
            // –°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            score = 0;
            lives = 3;
            timeLeft = 60;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
        }
        
        function resizeCanvas() {
            const gameArea = document.getElementById('gameArea');
            canvas.width = gameArea.clientWidth;
            canvas.height = gameArea.clientHeight;
            
            // –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä—ã –∏–≥—Ä–æ–∫–∞
            player.width = Math.min(40, canvas.width * 0.1);
            player.height = player.width * 1.5;
            player.speed = canvas.width * 0.02;
        }
        
        // ========== –£–ü–†–ê–í–õ–ï–ù–ò–ï –î–õ–Ø –¢–ï–õ–ï–§–û–ù–ê ==========
        function setupControls() {
            const leftZone = document.getElementById('leftZone');
            const rightZone = document.getElementById('rightZone');
            const fireButton = document.getElementById('fireButton');
            
            // –õ–ï–í–ê–Ø –ó–û–ù–ê
            leftZone.addEventListener('touchstart', (e) => {
                e.preventDefault();
                leftZoneActive = true;
                moveDirection = -1;
                leftZone.classList.add('active');
            });
            
            leftZone.addEventListener('touchend', (e) => {
                e.preventDefault();
                leftZoneActive = false;
                if (!rightZoneActive) moveDirection = 0;
                leftZone.classList.remove('active');
            });
            
            leftZone.addEventListener('mousedown', () => {
                leftZoneActive = true;
                moveDirection = -1;
                leftZone.classList.add('active');
            });
            
            leftZone.addEventListener('mouseup', () => {
                leftZoneActive = false;
                if (!rightZoneActive) moveDirection = 0;
                leftZone.classList.remove('active');
            });
            
            // –ü–†–ê–í–ê–Ø –ó–û–ù–ê
            rightZone.addEventListener('touchstart', (e) => {
                e.preventDefault();
                rightZoneActive = true;
                moveDirection = 1;
                rightZone.classList.add('active');
            });
            
            rightZone.addEventListener('touchend', (e) => {
                e.preventDefault();
                rightZoneActive = false;
                if (!leftZoneActive) moveDirection = 0;
                rightZone.classList.remove('active');
            });
            
            rightZone.addEventListener('mousedown', () => {
                rightZoneActive = true;
                moveDirection = 1;
                rightZone.classList.add('active');
            });
            
            rightZone.addEventListener('mouseup', () => {
                rightZoneActive = false;
                if (!leftZoneActive) moveDirection = 0;
                rightZone.classList.remove('active');
            });
            
            // –ö–ù–û–ü–ö–ê –û–ì–û–ù–¨
            fireButton.addEventListener('click', shoot);
            
            // –ö–õ–ê–í–ò–ê–¢–£–†–ê (–¥–ª—è —Ç–µ—Å—Ç–∞ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ)
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft') moveDirection = -1;
                if (e.key === 'ArrowRight') moveDirection = 1;
                if (e.key === ' ' || e.key === 'Spacebar') shoot();
            });
            
            document.addEventListener('keyup', (e) => {
                if (e.key === 'ArrowLeft' && moveDirection === -1) moveDirection = 0;
                if (e.key === 'ArrowRight' && moveDirection === 1) moveDirection = 0;
            });
            
            // –†–ï–°–ê–ô–ó –ü–†–ò –ü–û–í–û–†–û–¢–ï
            window.addEventListener('resize', resizeCanvas);
            window.addEventListener('orientationchange', () => {
                setTimeout(resizeCanvas, 100);
            });
        }
        
        // ========== –ò–ì–†–û–í–ê–Ø –õ–û–ì–ò–ö–ê ==========
        function gameLoop() {
            if (!isPlaying) return;
            
            // –û–ë–ù–û–í–õ–ï–ù–ò–ï
            updateGame();
            
            // –û–¢–†–ò–°–û–í–ö–ê
            drawGame();
            
            // –°–õ–ï–î–£–Æ–©–ò–ô –ö–ê–î–†
            window.gameLoopId = requestAnimationFrame(gameLoop);
        }
        
        function updateGame() {
            // –î–í–ò–ñ–ï–ù–ò–ï –ò–ì–†–û–ö–ê
            if (moveDirection === -1) {
                player.x = Math.max(0, player.x - player.speed);
            } else if (moveDirection === 1) {
                player.x = Math.min(canvas.width - player.width, player.x + player.speed);
            }
            
            // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–£–õ–¨
            for (let i = bullets.length - 1; i >= 0; i--) {
                bullets[i].y -= 10;
                
                // –£–¥–∞–ª–µ–Ω–∏–µ –ø—É–ª—å –∑–∞ —ç–∫—Ä–∞–Ω–æ–º
                if (bullets[i].y < 0) {
                    bullets.splice(i, 1);
                }
            }
            
            // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ê–°–¢–ï–†–û–ò–î–û–í
            for (let i = asteroids.length - 1; i >= 0; i--) {
                asteroids[i].y += asteroids[i].speed;
                
                // –°–¢–û–õ–ö–ù–û–í–ï–ù–ò–ï –° –ò–ì–†–û–ö–û–ú
                if (checkCollision(player, asteroids[i])) {
                    lives--;
                    createExplosion(asteroids[i].x, asteroids[i].y, asteroids[i].size);
                    asteroids.splice(i, 1);
                    updateUI();
                    
                    if (lives <= 0) {
                        gameOver();
                    }
                    continue;
                }
                
                // –°–¢–û–õ–ö–ù–û–í–ï–ù–ò–ï –° –ü–£–õ–Ø–ú–ò
                for (let j = bullets.length - 1; j >= 0; j--) {
                    if (checkCollision(bullets[j], asteroids[i])) {
                        score += 10;
                        createExplosion(asteroids[i].x, asteroids[i].y, asteroids[i].size);
                        asteroids.splice(i, 1);
                        bullets.splice(j, 1);
                        updateUI();
                        break;
                    }
                }
                
                // –£–î–ê–õ–ï–ù–ò–ï –ê–°–¢–ï–†–û–ò–î–û–í –ó–ê –≠–ö–†–ê–ù–û–ú
                if (asteroids[i].y > canvas.height) {
                    asteroids.splice(i, 1);
                }
            }
            
            // –û–ë–ù–û–í–õ–ï–ù–ò–ï –í–ó–†–´–í–û–í
            for (let i = explosions.length - 1; i >= 0; i--) {
                explosions[i].life--;
                if (explosions[i].life <= 0) {
                    explosions.splice(i, 1);
                }
            }
        }
        
        function drawGame() {
            // –§–û–ù
            ctx.fillStyle = 'rgba(10, 10, 30, 0.3)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –ó–í–ï–ó–î–´
            drawStars();
            
            // –ò–ì–†–û–ö
            drawPlayer();
            
            // –ü–£–õ–ò
            bullets.forEach(bullet => {
                ctx.fillStyle = '#ffff00';
                ctx.beginPath();
                ctx.arc(bullet.x, bullet.y, 5, 0, Math.PI * 2);
                ctx.fill();
                
                // –°–í–ï–ß–ï–ù–ò–ï
                ctx.shadowBlur = 15;
                ctx.shadowColor = '#ffff00';
                ctx.fill();
                ctx.shadowBlur = 0;
            });
            
            // –ê–°–¢–ï–†–û–ò–î–´
            asteroids.forEach(asteroid => {
                ctx.fillStyle = '#888888';
                ctx.beginPath();
                ctx.arc(asteroid.x, asteroid.y, asteroid.size, 0, Math.PI * 2);
                ctx.fill();
                
                // –¢–ï–ö–°–¢–£–†–ê
                ctx.fillStyle = '#666666';
                for (let j = 0; j < 3; j++) {
                    const angle = Math.random() * Math.PI * 2;
                    const radius = asteroid.size * 0.5;
                    ctx.beginPath();
                    ctx.arc(
                        asteroid.x + Math.cos(angle) * radius,
                        asteroid.y + Math.sin(angle) * radius,
                        asteroid.size * 0.2,
                        0, Math.PI * 2
                    );
                    ctx.fill();
                }
            });
            
            // –í–ó–†–´–í–´
            explosions.forEach(explosion => {
                const alpha = explosion.life / 20;
                ctx.globalAlpha = alpha;
                ctx.fillStyle = '#ff6600';
                ctx.beginPath();
                ctx.arc(explosion.x, explosion.y, explosion.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1.0;
            });
        }
        
        function drawStars() {
            ctx.fillStyle = '#ffffff';
            for (let i = 0; i < 50; i++) {
                const x = (i * 7.9) % canvas.width;
                const y = (i * 3.7) % canvas.height;
                const size = Math.random() * 1.5;
                
                ctx.beginPath();
                ctx.arc(x, y, size, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        function drawPlayer() {
            // –ö–û–†–ü–£–°
            ctx.fillStyle = '#00ccff';
            ctx.beginPath();
            ctx.moveTo(player.x + player.width/2, player.y);
            ctx.lineTo(player.x, player.y + player.height);
            ctx.lineTo(player.x + player.width, player.y + player.height);
            ctx.closePath();
            ctx.fill();
            
            // –ö–ê–ë–ò–ù–ê
            ctx.fillStyle = '#ffffff';
            ctx.beginPath();
            ctx.arc(
                player.x + player.width/2,
                player.y + player.height/3,
                player.width/4,
                0, Math.PI * 2
            );
            ctx.fill();
            
            // –î–í–ò–ì–ê–¢–ï–õ–¨
            ctx.fillStyle = '#ff6600';
            ctx.beginPath();
            ctx.moveTo(player.x + player.width/4, player.y + player.height);
            ctx.lineTo(player.x + player.width/3, player.y + player.height + 10);
            ctx.lineTo(player.x + player.width*2/3, player.y + player.height + 10);
            ctx.lineTo(player.x + player.width*3/4, player.y + player.height);
            ctx.fill();
        }
        
        function shoot() {
            if (!isPlaying) return;
            
            bullets.push({
                x: player.x + player.width/2,
                y: player.y,
                width: 4,
                height: 10
            });
        }
        
        function createExplosion(x, y, size) {
            explosions.push({
                x: x,
                y: y,
                size: size,
                life: 20
            });
        }
        
        function checkCollision(obj1, obj2) {
            return obj1.x < obj2.x + obj2.size * 2 &&
                   obj1.x + (obj1.width || 10) > obj2.x &&
                   obj1.y < obj2.y + obj2.size * 2 &&
                   (obj1.height || 10) + obj1.y > obj2.y;
        }
        
        // ========== –ò–ù–¢–ï–†–í–ê–õ–´ –ò–ì–†–´ ==========
        function startGameIntervals() {
            // –°–û–ó–î–ê–ù–ò–ï –ê–°–¢–ï–†–û–ò–î–û–í
            if (window.asteroidInterval) clearInterval(window.asteroidInterval);
            window.asteroidInterval = setInterval(() => {
                if (!isPlaying) return;
                
                const size = 15 + Math.random() * 15;
                asteroids.push({
                    x: Math.random() * (canvas.width - size * 2),
                    y: -size,
                    size: size,
                    speed: 1 + Math.random() * 3
                });
            }, 800);
            
            // –¢–ê–ô–ú–ï–†
            if (window.timerInterval) clearInterval(window.timerInterval);
            window.timerInterval = setInterval(() => {
                if (!isPlaying) {
                    clearInterval(window.timerInterval);
                    return;
                }
                
                timeLeft--;
                document.getElementById('time').textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    gameOver();
                }
            }, 1000);
        }
        
        function updateUI() {
            document.getElementById('score').textContent = score;
            document.getElementById('lives').textContent = lives;
        }
        
        function gameOver() {
            isPlaying = false;
            
            // –û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú –ò–ù–¢–ï–†–í–ê–õ–´
            if (window.gameLoopId) {
                cancelAnimationFrame(window.gameLoopId);
            }
            if (window.asteroidInterval) {
                clearInterval(window.asteroidInterval);
            }
            if (window.timerInterval) {
                clearInterval(window.timerInterval);
            }
            
            // –°–û–•–†–ê–ù–Ø–ï–ú –†–ï–ö–û–†–î
            const highScore = localStorage.getItem('spaceHighScore') || 0;
            if (score > highScore) {
                localStorage.setItem('spaceHighScore', score);
            }
            
            // –ü–û–ö–ê–ó–´–í–ê–ï–ú –†–ï–ó–£–õ–¨–¢–ê–¢
            setTimeout(() => {
                alert(`üéÆ –ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê!\n\n–í–∞—à —Å—á—ë—Ç: ${score}\n–†–µ–∫–æ—Ä–¥: ${Math.max(score, highScore)}`);
                showScreen('menuScreen');
            }, 500);
        }

        // ========== –ó–ê–ü–£–°–ö ==========
        window.addEventListener('load', () => {
            // Telegram WebApp
            try {
                const tg = window.Telegram?.WebApp;
                if (tg) {
                    tg.expand();
                    tg.enableClosingConfirmation();
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    const user = tg.initDataUnsafe?.user;
                    if (user) {
                        const tip = document.querySelector('#menuScreen div');
                        if (tip) {
                            tip.innerHTML = `
                                <p><i class="fas fa-user-astronaut"></i> <strong>–ü—Ä–∏–≤–µ—Ç, ${user.first_name}!</strong></p>
                                <p style="font-size: 14px; color: #00f7ff;">‚Ä¢ –¢–∞–ø–∞–π—Ç–µ –ø–æ –∑–æ–Ω–∞–º –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è</p>
                                <p style="font-size: 14px; color: #00f7ff;">‚Ä¢ –ù–∞–∂–∏–º–∞–π—Ç–µ –û–ì–û–ù–¨ –¥–ª—è —Å—Ç—Ä–µ–ª—å–±—ã</p>
                            `;
                        }
                    }
                }
            } catch (e) {}
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–∫–æ—Ä–¥
            const highScore = localStorage.getItem('spaceHighScore') || 0;
            if (highScore > 0) {
                const menuScreen = document.getElementById('menuScreen');
                const recordDiv = document.createElement('div');
                recordDiv.style.cssText = 'margin-top: 20px; padding: 10px; background: rgba(0,255,255,0.1); border-radius: 10px;';
                recordDiv.innerHTML = `<p><i class="fas fa-trophy"></i> –í–∞—à —Ä–µ–∫–æ—Ä–¥: <strong>${highScore}</strong></p>`;
                menuScreen.appendChild(recordDiv);
            }
        });
    </script>
</body>
</html>
